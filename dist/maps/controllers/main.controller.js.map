{"version":3,"sources":["controllers/main.controller.js"],"names":["app","controller","$scope","$state","$rootScope","$toast","$firebaseAuth","$firebaseObject","state","user","navOpen","navTapped","auth","slideAway","document","querySelector","className","setTimeout","toggleNav","signInWithGoogle","provider","firebase","GoogleAuthProvider","signInWithPopup","then","data","database","child","uid","once","console","log","val","go","googleLogin","catch","error","forgotPassword","wrongPassword","login","signInWithEmailAndPassword","email","password","fetchUserData","err","code","logout","signOut","loggedIn"],"mappings":"AAAAA,IAAIC,WAAW,YAAa,SAAU,SAAU,aAAc,SAAU,gBAAiB,kBACvF,SAASC,EAAQC,EAAQC,EAAYC,EAAQC,EAAeC,GACzDL,EAAOM,MAAQL,EACfD,EAAOO,QACPL,EAAWM,SAAU,EACrBR,EAAOS,WAAY,EACnBT,EAAOU,KAAON,IAIjBF,EAAWS,UAAY,WACtBC,SAASC,cAAc,YAAYC,UAAY,SACtCF,SAASC,cAAc,YAAYC,UAAY,iBAC/CC,WAAW,WACTH,SAASC,cAAc,YAAYC,UAAY,UAC9C,MAGbd,EAAOgB,UAAY,WAClBD,WAAW,WACVf,EAAOS,WAAY,GACjB,KACAT,EAAOS,YAGNP,EAAWM,QAIFR,EAAOW,aAHlBC,SAASC,cAAc,YAAYC,WAAa,QACvCF,SAASC,cAAc,YAAYC,WAAa,SAI3DZ,EAAWM,SAAWN,EAAWM,QACjCR,EAAOS,WAAY,IAIpBT,EAAOiB,iBAAmB,WACzB,GAAIC,GAAW,GAAIC,UAAST,KAAKU,kBAEjCD,UAAST,OAAOW,gBAAgBH,GAC9BI,KAAK,SAASC,GACb,MAAOvB,GAAOwB,SAASC,MAAM,SAAWF,EAAKhB,KAAKmB,KAAKC,KAAK,WAE7DL,KAAK,SAASC,GACdK,QAAQC,IAAIN,EAAKO,OACA,MAAdP,EAAKO,OACP3B,EAAO,yBACPF,EAAO8B,GAAG,YAAaC,aAAe,KAEtC/B,EAAO8B,GAAG,iBAGXE,MAAM,SAASC,GACb/B,EAAO,uBACPyB,QAAQC,IAAIK,MAIjBlC,EAAOmC,eAAiB,WACvBnC,EAAOoC,eAAgB,GAGxBpC,EAAOqC,MAAQ,WACdlB,SAAST,OAAO4B,2BAA2BtC,EAAOO,KAAKgC,MAAOvC,EAAOO,KAAKiC,UACxElB,KAAK,SAASC,GACdK,QAAQC,IAAIN,EAAKG,KACjB1B,EAAOyC,cAAclB,EAAKG,KAE1BzB,EAAO8B,GAAG,WACT5B,EAAO,cAER8B,MAAM,SAASS,GACfd,QAAQC,IAAI,QAASa,GACN,uBAAZA,EAAIC,MACNxC,EAAO,sBAEO,uBAAZuC,EAAIC,MACNxC,EAAO,qBAIXH,EAAO4C,OAAS,WACfzB,SAAST,OAAOmC,UAAUvB,KAAK,WAC5BpB,EAAW4C,UAAW,EACtB7C,EAAO8B,GAAG,SACV5B,EAAO,gBACP,SAAS+B,GACT/B,EAAO","file":"controllers/main.controller.js","sourcesContent":["app.controller('mainCtrl', ['$scope', '$state', '$rootScope', '$toast', '$firebaseAuth', '$firebaseObject',\n\t\tfunction($scope, $state, $rootScope, $toast, $firebaseAuth, $firebaseObject){\n\t    $scope.state = $state;\n\t    $scope.user = {};\t    \n\t    $rootScope.navOpen = false;\n\t    $scope.navTapped = false;\n\t    $scope.auth = $firebaseAuth();\n\t    \n\t\t//var provider = new firebase.auth.GoogleAuthProvider();\t\n\n\t\t$rootScope.slideAway = function(){\n\t\t\tdocument.querySelector('#sideNav').className = \"mobile\";\n            document.querySelector('#overlay').className = \"mobile fadeOut\";\n            setTimeout(function(){\n              document.querySelector('#overlay').className = \"mobile\";      \n            }, 300);     \n\t\t}\n\n\t\t$scope.toggleNav = function(){\t\t\t\n\t\t\tsetTimeout(function(){\n\t\t\t\t$scope.navTapped = false;\n\t\t\t}, 300);\n\t\t\tif($scope.navTapped){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!$rootScope.navOpen){\n\t\t\t\t document.querySelector('#sideNav').className += \" show\";  \n           \t\t document.querySelector('#overlay').className += \" show\";\n\t\t\t}else{\n                $scope.slideAway();           \n\t\t\t}\n\t\t\t$rootScope.navOpen = !$rootScope.navOpen;\n\t\t\t$scope.navTapped = true;\n\t\t}\t\n\n\n\t\t$scope.signInWithGoogle = function(){\n\t\t\tvar provider = new firebase.auth.GoogleAuthProvider();\n\n\t\t\tfirebase.auth().signInWithPopup(provider)\n\t\t\t\t.then(function(data) {\n\t\t\t\t  return $scope.database.child('users/' + data.user.uid).once('value')\n\t\t\t\t})\n\t\t\t\t.then(function(data){\n\t\t\t\t\tconsole.log(data.val());\n\t\t\t\t\tif(data.val() == null){\n\t\t\t\t\t\t$toast('Please Register First');\n\t\t\t\t\t\t$state.go('register', {\"googleLogin\": true});\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$state.go('accountPage');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function(error) {\n\t\t\t\t  \t$toast('Google Login Failed');\n\t\t\t\t  \tconsole.log(error);\n\t\t\t\t});\n\t\t}\n\n\t\t$scope.forgotPassword = function(){\n\t\t\t$scope.wrongPassword = true;\n\t\t}\n\t\t//https://github.com/firebase/angularfire/blob/master/docs/reference.md#firebaseauth\n\t\t$scope.login = function(){\n\t\t\tfirebase.auth().signInWithEmailAndPassword($scope.user.email, $scope.user.password)\n\t\t\t\t.then(function(data){\n\t\t\t\t\tconsole.log(data.uid);\n\t\t\t\t\t$scope.fetchUserData(data.uid);\n\t\t\t\t\t// Go to choice screen, see notes.md for reference \n\t\t\t\t\t$state.go('booking');\n\t\t\t\t \t$toast('Welcome!');\n\t\t\t    })\n\t\t\t\t.catch(function(err){\n\t\t\t\t\tconsole.log(\"error\", err);\n\t\t\t\t\tif(err.code == 'auth/user-not-found'){\n\t\t\t\t\t $toast('Unrecognized email');\n\t\t\t\t\t}\n\t\t\t\t\tif(err.code == 'auth/wrong-password'){\t\t\t\t\t\t\n\t\t\t\t\t $toast('Wrong password');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\t\t$scope.logout = function(){\n\t\t\tfirebase.auth().signOut().then(function() {\n\t\t\t   $rootScope.loggedIn = false;\n\t\t\t   $state.go('login');\n\t\t\t   $toast('Logged out!');\t\t\t    \n\t\t\t}, function(error) {\n\t\t\t   $toast('Logout failed!');\t\t\t    \n\t\t\t});\n\t\t}\n\t}])"],"sourceRoot":"/source/"}